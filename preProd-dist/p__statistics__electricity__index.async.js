"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{243:function(J,S,r){r.d(S,{EI:function(){return k},Ey:function(){return Z},G3:function(){return A},GB:function(){return j},Gv:function(){return M},Kr:function(){return X},MT:function(){return H},Tn:function(){return F},UW:function(){return W},V4:function(){return K},VA:function(){return C},X3:function(){return h},_n:function(){return I},bG:function(){return f},ch:function(){return R},d_:function(){return w},lp:function(){return L},qX:function(){return Y},tf:function(){return z},wn:function(){return D}});var d=r(72179),B=function(){return axiosInstance.get("/energy/dtu/getAllDevicesByDtuId")},L=function(t){return d.Z.post("/minsys/revenue/getRevenueByKey",t)},f=function(t){return d.Z.get("/minsys/revenue/getPlantRevenue",{params:t})},A=function(t){return d.Z.get("/minsys/dtu/getDeviceTypeByDtuId",{params:t})},D=function(t){return d.Z.get("/minsys/dtu/dtuOverView",{params:t})},W=function(t){return d.Z.post("/minsys/revenue/exportRevenue",t,{responseType:"blob"})},I=function(t){return d.Z.post("/minsys/revenue/exportElectricity",t,{responseType:"blob"})},Z=function(t){return d.Z.get("/minsys/dtu/dtuDetailInfo",{params:t})},j=function(t){return d.Z.get("/minsys/strategy/getStrategyData",{params:t})},M=function(t){return d.Z.get("/minsys/strategy/verifyPassword",{params:t})},h=function(t){return d.Z.post("/minsys/strategy/sendPCSSetting",t)},m=function(t){return axiosInstance.post("/minsys/strategy/sendBMSSetting",t)},Y=function(t){return d.Z.post("/minsys/strategy/sendPCSPower",t)},z=function(t){return d.Z.post("/minsys/strategy/sendParamSetting",t)},H=function(t){return d.Z.post("/minsys/strategy/sendStrategySelect",t)},K=function(t){return d.Z.post("/minsys/strategy/sendDehumidifier",t)},R=function(t){return d.Z.post("/minsys/strategy/sendLiquidCooler",t)},w=function(t){return d.Z.post("/minsys/strategy/switchModes",t)},k=function(t){return d.Z.post("/minsys/strategy/sendStrategySetting",t)},C=function(t){return d.Z.get("/minsys/strategy/updateData",{params:t})},X=function(t){return d.Z.post("/energy/plant/getPlantList",t)},F=function(t){return d.Z.post("/minsys/revenue/showDataByTable",t)}},16075:function(J,S,r){r.d(S,{Cj:function(){return I},EW:function(){return A},Kh:function(){return M},jB:function(){return W},qL:function(){return j},rD:function(){return L},vz:function(){return Z}});var d=r(72179),B="/total",L=function(m){return d.Z.post("/energy/fetchPlantListByRoot",m)},f=function(m){return axiosInstance.post("".concat(B,"/insertPlant"),m)},A=function(m){return d.Z.post("/energy/updatePlant",m)},D=function(m){return axiosInstance.get("".concat(B,"/getPlantById?plantId=").concat(m.plantId))},W=function(m){return d.Z.get("/energy/deletePlant?plantId=".concat(m.plantId))},I=function(){return d.Z.get("/energy/fetchPlantInitData")},Z=function(m){return d.Z.get("/energy/getDtusOfPlant?plantId=".concat(m.plantId))},j=function(m){return d.Z.get("/minsys/getBurEnergyStats2?plantId=".concat(m.plantId))},M=function(m){return d.Z.get("/energy/getDeviceStats?plantId=".concat(m.plantId))}},71050:function(J,S,r){r.r(S);var d=r(15558),B=r.n(d),L=r(90228),f=r.n(L),A=r(87999),D=r.n(A),W=r(48305),I=r.n(W),Z=r(4552),j=r(68308),M=r(76072),h=r(86910),m=r(95818),Y=r(69879),z=r(26165),H=r(54213),K=r(80233),R=r(40926),w=r(6126),k=r(8638),C=r(18615),X=r(36525),F=r(5552),_=r(34103),t=r(93236),ce=r(5726),P=r.n(ce),Q=r(91797),ve=r(11333),x=r.n(ve),$=r(243),_e=r(16075),fe=r(66051),u=r(62086),me=P()(x()().subtract(5,"day").format("YYYY-MM-DD")),ge=P()(x()().subtract(1,"day").format("YYYY-MM-DD")),ye=function(){var l=(0,Z.useIntl)(),pe=j.Z.useToken(),De=pe.token,he=M.Z.useForm(),Ee=I()(he,1),b=Ee[0],Me=(0,t.useState)([]),q=I()(Me,2),g=q[0],ee=q[1],Pe=(0,t.useState)([]),te=I()(Pe,2),Ie=te[0],Oe=te[1],Te=(0,t.useState)({}),ne=I()(Te,2),Se=ne[0],Ce=ne[1],xe=(0,t.useState)([]),ae=I()(xe,2),re=ae[0],Be=ae[1],Le=(0,t.useState)(!1),ie=I()(Le,2),se=ie[0],le=ie[1],G=function(){var v=D()(f()().mark(function o(){var e,a,n,i,c,s;return f()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return e="YYYY-MM-DD",p.next=3,b.validateFields();case 3:if(a=p.sent,n=a.timeType,i=a.currentPlantDevice,c={},n==="year"&&(e="YYYY",c={plantId:i==null?void 0:i[0],dtuId:i==null?void 0:i[1],date:P()(a.yearTime).format(e),dateType:n}),n!="day"){p.next=13;break}if(s=P()(P()(a.dayTime[1]).format(e)).diff(P()(a.dayTime[0]).format(e),"days")+1,!(s<5||s>12)){p.next=12;break}return h.ZP.error(l.formatMessage({id:"\u65E5\u671F\u8303\u56F4\u6700\u5C11\u9009\u62E95\u5929\u6700\u591A\u9009\u62E912\u5929\uFF01"})),p.abrupt("return");case 12:c={plantId:i==null?void 0:i[0],dtuId:i==null?void 0:i[1],startDate:P()(a.dayTime[0]).format(e),endDate:P()(a.dayTime[1]).format(e),dateType:n};case 13:return p.abrupt("return",c);case 14:case"end":return p.stop()}},o)}));return function(){return v.apply(this,arguments)}}(),Ae=function(){var v=D()(f()().mark(function o(){var e,a,n;return f()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,b.validateFields();case 2:e=c.sent,a=e.timeType,n={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:"40",right:"4%",left:"5%",bottom:"30"},xAxis:[{type:"category",data:g==null?void 0:g.map(function(s){return x()(s.time).format(a==="day"?"YYYY/MM/DD":"YYYY/MM")}),axisLine:{lineStyle:{color:"rgba(255,255,255,0.12)"}},axisLabel:{margin:10,color:"white",textStyle:{fontSize:14}}}],yAxis:[{name:"".concat(l.formatMessage({id:"\u7535\u91CF"}),"(kWh)"),nameTextStyle:{color:"white"},axisLabel:{formatter:"{value}",color:"#e2e9ff"},axisLine:{show:!1},splitLine:{show:!0,lineStyle:{color:"#233e64"}}},{name:"".concat(l.formatMessage({id:"\u5145\u653E\u7535\u6548\u7387"}),"(%)"),nameTextStyle:{color:"white"},axisLabel:{formatter:"{value}",color:"#e2e9ff"},axisLine:{show:!1},splitLine:{show:!0,lineStyle:{color:"#233e64"}}}],series:[{type:"bar",data:g==null?void 0:g.map(function(s){return s.dayChargeEnergy}),barWidth:40,name:"".concat(l.formatMessage({id:"\u5145\u7535\u91CF"}),"(kWh)"),itemStyle:{normal:{color:new Q.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#FFC47A"},{offset:1,color:"#FF670A"}],!1)}}},{type:"bar",data:g==null?void 0:g.map(function(s){return s.dayDischargeEnergy}),barWidth:40,name:"".concat(l.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),itemStyle:{normal:{color:new Q.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#00F3FB"},{offset:1,color:"#0050F9"}],!1)}}},{type:"line",data:g==null?void 0:g.map(function(s){return s.cDEfficiency}),yAxisIndex:1,name:"".concat(l.formatMessage({id:"\u5145\u653E\u7535\u6548\u7387"}),"(%)"),lineStyle:{color:"#00FF05",width:4}}]},Ce(n);case 6:case"end":return c.stop()}},o)}));return function(){return v.apply(this,arguments)}}(),oe=function(){var v=D()(f()().mark(function o(e,a){var n,i,c,s,y,p,O,T,V;return f()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,_e.vz)({plantId:a});case 2:if(i=E.sent,!(i!=null&&(n=i.data)!==null&&n!==void 0&&n.data)){E.next=20;break}if(s=i==null||(c=i.data)===null||c===void 0?void 0:c.data,!s){E.next=20;break}try{s=JSON.parse(s)}catch(U){s=[]}return s=((y=s)===null||y===void 0?void 0:y.length)>0?(p=s)===null||p===void 0?void 0:p.map(function(U){return{value:U.id,label:U.name||l.formatMessage({id:"\u8BBE\u5907\u65E0\u540D\u79F0"})}}):[],O=e==null?void 0:e.findIndex(function(U){return U.value===a}),e[O].children=s,Be(B()(e)),E.next=13,b.getFieldValue("currentPlantDevice");case 13:if(T=E.sent,(T==null?void 0:T.length)!==0){E.next=20;break}return b.setFieldsValue({currentPlantDevice:[a,s[0].value]}),E.next=18,G();case 18:V=E.sent,de(V);case 20:case"end":return E.stop()}},o)}));return function(e,a){return v.apply(this,arguments)}}(),We=function(){var v=D()(f()().mark(function o(){var e,a,n,i,c,s,y;return f()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,$.Kr)();case 2:a=O.sent,a!=null&&(e=a.data)!==null&&e!==void 0&&e.data&&(c=a==null||(n=a.data)===null||n===void 0?void 0:n.data,s=c==null||(i=c.plantList)===null||i===void 0?void 0:i.map(function(T,V){var N;return{value:T.plantId,label:T.name,children:(c==null||(N=c.deviceCount)===null||N===void 0?void 0:N[V])&&[{value:"",label:""}]}}),(s==null?void 0:s.length)>0&&oe(s,s==null||(y=s[0])===null||y===void 0?void 0:y.value));case 4:case"end":return O.stop()}},o)}));return function(){return v.apply(this,arguments)}}(),ue=function(){var v=D()(f()().mark(function o(){var e,a,n,i,c;return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,G();case 2:return a=y.sent,y.next=5,(0,$.Tn)(a);case 5:n=y.sent,n!=null&&(e=n.data)!==null&&e!==void 0&&(e=e.data)!==null&&e!==void 0&&e.data&&(c=n==null||(i=n.data)===null||i===void 0||(i=i.data)===null||i===void 0?void 0:i.data,Oe(c));case 7:case"end":return y.stop()}},o)}));return function(){return v.apply(this,arguments)}}(),de=function(){var v=D()(f()().mark(function o(e){var a,n,i;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return le(!0),s.next=3,(0,$.lp)(e);case 3:n=s.sent,n!=null&&(a=n.data)!==null&&a!==void 0&&(a=a.data)!==null&&a!==void 0&&a.data?ee(n==null||(i=n.data)===null||i===void 0||(i=i.data)===null||i===void 0?void 0:i.data):ee([]),le(!1);case 6:case"end":return s.stop()}},o)}));return function(e){return v.apply(this,arguments)}}();return(0,t.useEffect)(function(){Ae()},[g]),(0,t.useEffect)(function(){We(),ue()},[]),(0,u.jsxs)(m.Z,{size:10,direction:"vertical",style:{width:"100%",height:"100%",padding:30},children:[(0,u.jsxs)(Y.Z,{justify:"center",align:"center",gap:10,children:[(0,u.jsxs)("span",{children:[l.formatMessage({id:"\u6570\u636E\u9879"}),"\uFF1A"]}),(0,u.jsx)(M.Z,{form:b,layout:"inline",initialValues:{currentPlantDevice:[],dayTime:[me,ge],yearTime:P()(),timeType:"day"},children:(0,u.jsxs)(Y.Z,{align:"center",children:[(0,u.jsx)(M.Z.Item,{name:"currentPlantDevice",children:(0,u.jsx)(z.Z,{changeOnSelect:!0,options:re,onChange:function(){var v=D()(f()().mark(function o(e){return f()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:(e==null?void 0:e.length)===1&&oe(re,e[0]);case 1:case"end":return n.stop()}},o)}));return function(o){return v.apply(this,arguments)}}(),style:{width:"250px",height:40}})}),(0,u.jsx)(M.Z.Item,{noStyle:!0,dependencies:["timeType"],children:function(o){var e=o.getFieldsValue,a=e(["timeType"]),n=a.timeType;return n==="day"?(0,u.jsx)(H.Z,{title:l.formatMessage({id:"\u65E5\u671F\u8303\u56F4\u6700\u5C11\u9009\u62E95\u5929\u6700\u591A\u9009\u62E912\u5929\uFF01"}),children:(0,u.jsx)(M.Z.Item,{name:"dayTime",children:(0,u.jsx)(K.Z.RangePicker,{maxDate:P()(x()().subtract(1,"day").format("YYYY-MM-DD"),"YYYY-MM-DD"),style:{width:"300px",height:40},allowClear:!1})})}):(0,u.jsx)(M.Z.Item,{name:"yearTime",children:(0,u.jsx)(K.Z,{allowClear:!1,maxDate:P()(x()().format("YYYY")),picker:"year",style:{width:"250px",height:40}})})}}),(0,u.jsx)(M.Z.Item,{name:"timeType",children:(0,u.jsxs)(R.ZP.Group,{size:"large",children:[(0,u.jsx)(R.ZP.Button,{value:"day",children:l.formatMessage({id:"\u65E5"})}),(0,u.jsx)(R.ZP.Button,{value:"year",children:l.formatMessage({id:"\u5E74"})})]})})]})}),(0,u.jsx)(w.ZP,{onClick:D()(f()().mark(function v(){var o;return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,G();case 2:o=a.sent,o&&(de(o),ue());case 4:case"end":return a.stop()}},v)})),type:"primary",style:{padding:"0 20px",height:40},children:l.formatMessage({id:"\u67E5\u8BE2"})}),(0,u.jsxs)(w.ZP,{type:"primary",onClick:D()(f()().mark(function v(){var o,e;return f()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,G();case 2:return o=n.sent,n.next=5,(0,$._n)(o);case 5:e=n.sent,e!=null&&e.data&&(0,fe.Sv)({fileName:"".concat(l.formatMessage({id:"\u7535\u91CF\u7EDF\u8BA1"}),".xlsx"),content:e==null?void 0:e.data});case 7:case"end":return n.stop()}},v)})),style:{backgroundColor:De.defaultBg,padding:"0 20px",height:40},children:[l.formatMessage({id:"\u5BFC\u51FA"})," Excel"]})]}),(0,u.jsx)(F.Dx,{title:"".concat(l.formatMessage({id:"\u7535\u91CF\u7EDF\u8BA1"}))}),(0,u.jsx)(k.Z,{spinning:se,children:(0,u.jsx)(m.Z,{direction:"vertical",style:{width:"100%"},children:(0,u.jsx)("div",{style:{width:"100%",height:"calc(50vh - 150px)"},children:(g==null?void 0:g.length)>0?(0,u.jsx)(_.Z,{option:Se,notMerge:!0,style:{width:"100%",height:"100%"}}):(0,u.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,u.jsx)(C.Z,{image:C.Z.PRESENTED_IMAGE_SIMPLE,description:l.formatMessage({id:"\u6682\u65E0\u6570\u636E"})})})})})}),(0,u.jsx)(F.Dx,{title:"".concat(l.formatMessage({id:"\u7535\u91CF\u660E\u7EC6"}))}),(0,u.jsx)(k.Z,{spinning:se,children:(0,u.jsx)(m.Z,{direction:"vertical",style:{width:"100%"},children:(0,u.jsx)("div",{style:{width:"100%",height:"calc(50vh - 150px)"},children:(g==null?void 0:g.length)>0?(0,u.jsx)(X.Z,{pagination:!1,dataSource:Ie,columns:[{title:l.formatMessage({id:"\u65E5\u671F"}),dataIndex:"time",key:"time",render:function(o,e){return x()(o).format((e==null?void 0:e.dateType)==="year"?"YYYY/MM":"YYYY/MM/DD")}},{title:l.formatMessage({id:"\u8BBE\u5907\u540D\u79F0"}),dataIndex:"dtuName",key:"dtuName"},{title:l.formatMessage({id:"sn\u53F7"}),dataIndex:"sn",key:"sn"},{title:"".concat(l.formatMessage({id:"\u603B\u5145\u7535\u91CF"}),"/").concat(l.formatMessage({id:"\u603B\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(o,e){return"".concat(e==null?void 0:e.dayChargeEnergy,"/").concat(e==null?void 0:e.dayDischargeEnergy)}},{title:"".concat(l.formatMessage({id:"\u5145\u653E\u7535\u6548\u7387"}),"(%)"),dataIndex:"cDEfficiency",key:"cDEfficiency"},{title:"".concat(l.formatMessage({id:"\u6536\u76CA"}),"(\u5143)"),dataIndex:"number",key:"number"},{title:"".concat(l.formatMessage({id:"\u5C16\u65F6\u6BB5"})).concat(l.formatMessage({id:"\u5145\u7535\u91CF"}),"/").concat(l.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(o,e){return"".concat(e==null?void 0:e.tipChargeEnergy,"/").concat(e==null?void 0:e.tipDischargeEnergy)}},{title:"".concat(l.formatMessage({id:"\u5CF0\u65F6\u6BB5"})).concat(l.formatMessage({id:"\u5145\u7535\u91CF"}),"/").concat(l.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(o,e){return"".concat(e==null?void 0:e.peakChargeEnergy,"/").concat(e==null?void 0:e.peakDischargeEnergy)}},{title:"".concat(l.formatMessage({id:"\u5E73\u65F6\u6BB5"})).concat(l.formatMessage({id:"\u5145\u7535\u91CF"}),"/").concat(l.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(o,e){return"".concat(e==null?void 0:e.flatChargeEnergy,"/").concat(e==null?void 0:e.flatDischargeEnergy)}},{title:"".concat(l.formatMessage({id:"\u8C37\u65F6\u6BB5"})).concat(l.formatMessage({id:"\u5145\u7535\u91CF"}),"/").concat(l.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(o,e){return"".concat(e==null?void 0:e.valleyChargeEnergy,"/").concat(e==null?void 0:e.valleyDischargeEnergy)}}],scroll:{y:"calc(100vh - 820px)"}}):(0,u.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,u.jsx)(C.Z,{image:C.Z.PRESENTED_IMAGE_SIMPLE,description:l.formatMessage({id:"\u6682\u65E0\u6570\u636E"})})})})})})]})};S.default=ye}}]);

"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{243:function(J,C,i){i.d(C,{EI:function(){return k},Ey:function(){return A},G3:function(){return W},GB:function(){return b},Gv:function(){return M},Kr:function(){return X},MT:function(){return H},Tn:function(){return F},UW:function(){return Z},V4:function(){return K},VA:function(){return x},X3:function(){return h},_n:function(){return I},bG:function(){return y},ch:function(){return j},d_:function(){return w},lp:function(){return L},qX:function(){return Y},tf:function(){return z},wn:function(){return D}});var d=i(72179),S=function(){return axiosInstance.get("/energy/dtu/getAllDevicesByDtuId")},L=function(t){return d.Z.post("/minsys/revenue/getRevenueByKey",t)},y=function(t){return d.Z.get("/minsys/revenue/getPlantRevenue",{params:t})},W=function(t){return d.Z.get("/minsys/dtu/getDeviceTypeByDtuId",{params:t})},D=function(t){return d.Z.get("/minsys/dtu/dtuOverView",{params:t})},Z=function(t){return d.Z.post("/minsys/revenue/exportRevenue",t,{responseType:"blob"})},I=function(t){return d.Z.post("/minsys/revenue/exportElectricity",t,{responseType:"blob"})},A=function(t){return d.Z.get("/minsys/dtu/dtuDetailInfo",{params:t})},b=function(t){return d.Z.get("/minsys/strategy/getStrategyData",{params:t})},M=function(t){return d.Z.get("/minsys/strategy/verifyPassword",{params:t})},h=function(t){return d.Z.post("/minsys/strategy/sendPCSSetting",t)},p=function(t){return axiosInstance.post("/minsys/strategy/sendBMSSetting",t)},Y=function(t){return d.Z.post("/minsys/strategy/sendPCSPower",t)},z=function(t){return d.Z.post("/minsys/strategy/sendParamSetting",t)},H=function(t){return d.Z.post("/minsys/strategy/sendStrategySelect",t)},K=function(t){return d.Z.post("/minsys/strategy/sendDehumidifier",t)},j=function(t){return d.Z.post("/minsys/strategy/sendLiquidCooler",t)},w=function(t){return d.Z.post("/minsys/strategy/switchModes",t)},k=function(t){return d.Z.post("/minsys/strategy/sendStrategySetting",t)},x=function(t){return d.Z.get("/minsys/strategy/updateData",{params:t})},X=function(t){return d.Z.post("/energy/plant/getPlantList",t)},F=function(t){return d.Z.post("/minsys/revenue/showDataByTable",t)}},16075:function(J,C,i){i.d(C,{Cj:function(){return I},EW:function(){return W},Kh:function(){return M},jB:function(){return Z},qL:function(){return b},rD:function(){return L},vz:function(){return A}});var d=i(72179),S="/total",L=function(p){return d.Z.post("/energy/fetchPlantListByRoot",p)},y=function(p){return axiosInstance.post("".concat(S,"/insertPlant"),p)},W=function(p){return d.Z.post("/energy/updatePlant",p)},D=function(p){return axiosInstance.get("".concat(S,"/getPlantById?plantId=").concat(p.plantId))},Z=function(p){return d.Z.get("/energy/deletePlant?plantId=".concat(p.plantId))},I=function(){return d.Z.get("/energy/fetchPlantInitData")},A=function(p){return d.Z.get("/energy/getDtusOfPlant?plantId=".concat(p.plantId))},b=function(p){return d.Z.get("/minsys/getBurEnergyStats2?plantId=".concat(p.plantId))},M=function(p){return d.Z.get("/energy/getDeviceStats?plantId=".concat(p.plantId))}},71050:function(J,C,i){i.r(C);var d=i(15558),S=i.n(d),L=i(90228),y=i.n(L),W=i(87999),D=i.n(W),Z=i(48305),I=i.n(Z),A=i(4552),b=i(68308),M=i(76072),h=i(86910),p=i(95818),Y=i(69879),z=i(26165),H=i(54213),K=i(80233),j=i(40926),w=i(6126),k=i(8638),x=i(18615),X=i(36525),F=i(5552),_=i(34103),t=i(93236),ce=i(5726),P=i.n(ce),Q=i(91797),ve=i(11333),B=i.n(ve),$=i(243),_e=i(16075),fe=i(66051),o=i(62086),me=P()(B()().subtract(5,"day").format("YYYY-MM-DD")),ge=P()(B()().subtract(1,"day").format("YYYY-MM-DD")),ye=function(){var s=(0,A.useIntl)(),pe=b.Z.useToken(),De=pe.token,he=M.Z.useForm(),Ee=I()(he,1),R=Ee[0],Me=(0,t.useState)([]),q=I()(Me,2),m=q[0],ee=q[1],Pe=(0,t.useState)([]),te=I()(Pe,2),Ie=te[0],Oe=te[1],Te=(0,t.useState)({}),ae=I()(Te,2),Ce=ae[0],Se=ae[1],xe=(0,t.useState)([]),ne=I()(xe,2),re=ne[0],Be=ne[1],Le=(0,t.useState)(!1),ie=I()(Le,2),se=ie[0],le=ie[1],G=function(){var c=D()(y()().mark(function l(){var e,n,a,r,f,u;return y()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return e="YYYY-MM-DD",v.next=3,R.validateFields();case 3:if(n=v.sent,a=n.timeType,r=n.currentPlantDevice,f={},a==="year"&&(e="YYYY",f={plantId:r==null?void 0:r[0],dtuId:r==null?void 0:r[1],date:P()(n.yearTime).format(e),dateType:a}),a!="day"){v.next=13;break}if(u=P()(P()(n.dayTime[1]).format(e)).diff(P()(n.dayTime[0]).format(e),"days")+1,!(u<5||u>12)){v.next=12;break}return h.ZP.error(s.formatMessage({id:"\u65E5\u671F\u8303\u56F4\u6700\u5C11\u9009\u62E95\u5929\u6700\u591A\u9009\u62E912\u5929\uFF01"})),v.abrupt("return");case 12:f={plantId:r==null?void 0:r[0],dtuId:r==null?void 0:r[1],startDate:P()(n.dayTime[0]).format(e),endDate:P()(n.dayTime[1]).format(e),dateType:a};case 13:return v.abrupt("return",f);case 14:case"end":return v.stop()}},l)}));return function(){return c.apply(this,arguments)}}(),We=function(){var c=D()(y()().mark(function l(){var e,n,a,r,f;return y()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,R.validateFields();case 2:e=g.sent,n=e.timeType,a=Number(Math.max.apply(Math,S()((m==null?void 0:m.map(function(v){return v.dayChargeEnergy}))||[]))),a=Math.ceil(a/5)*5||100,r=a/5,f={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:"40",right:"4%",left:"5%",bottom:"30"},xAxis:[{type:"category",data:m==null?void 0:m.map(function(v){return B()(v.time).format(n==="day"?"YYYY/MM/DD":"YYYY/MM")}),axisLine:{lineStyle:{color:"rgba(255,255,255,0.12)"}},axisLabel:{margin:10,color:"white",textStyle:{fontSize:14}}}],yAxis:[{name:"".concat(s.formatMessage({id:"\u7535\u91CF"}),"(kWh)"),nameTextStyle:{color:"white"},axisLabel:{formatter:"{value}",color:"#e2e9ff"},axisLine:{show:!1},splitLine:{show:!0,lineStyle:{color:"#233e64"}},min:0,max:a,interval:r},{name:"".concat(s.formatMessage({id:"\u5145\u653E\u7535\u6548\u7387"}),"(%)"),nameTextStyle:{color:"white"},axisLabel:{formatter:"{value}",color:"#e2e9ff"},axisLine:{show:!1},splitLine:{show:!0,lineStyle:{color:"#233e64"}},min:0,max:100,splitNumber:5}],series:[{type:"bar",data:m==null?void 0:m.map(function(v){return v.dayChargeEnergy}),barWidth:40,name:"".concat(s.formatMessage({id:"\u5145\u7535\u91CF"}),"(kWh)"),itemStyle:{normal:{color:new Q.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#FFC47A"},{offset:1,color:"#FF670A"}],!1)}}},{type:"bar",data:m==null?void 0:m.map(function(v){return v.dayDischargeEnergy}),barWidth:40,name:"".concat(s.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),itemStyle:{normal:{color:new Q.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#00F3FB"},{offset:1,color:"#0050F9"}],!1)}}},{type:"line",data:m==null?void 0:m.map(function(v){return v.cDEfficiency}),yAxisIndex:1,name:"".concat(s.formatMessage({id:"\u5145\u653E\u7535\u6548\u7387"}),"(%)"),lineStyle:{color:"#00FF05",width:4}}]},Se(f);case 9:case"end":return g.stop()}},l)}));return function(){return c.apply(this,arguments)}}(),oe=function(){var c=D()(y()().mark(function l(e,n){var a,r,f,u,g,v,O,T,V;return y()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,_e.vz)({plantId:n});case 2:if(r=E.sent,!(r!=null&&(a=r.data)!==null&&a!==void 0&&a.data)){E.next=20;break}if(u=r==null||(f=r.data)===null||f===void 0?void 0:f.data,!u){E.next=20;break}try{u=JSON.parse(u)}catch(U){u=[]}return u=((g=u)===null||g===void 0?void 0:g.length)>0?(v=u)===null||v===void 0?void 0:v.map(function(U){return{value:U.id,label:U.name||s.formatMessage({id:"\u8BBE\u5907\u65E0\u540D\u79F0"})}}):[],O=e==null?void 0:e.findIndex(function(U){return U.value===n}),e[O].children=u,Be(S()(e)),E.next=13,R.getFieldValue("currentPlantDevice");case 13:if(T=E.sent,(T==null?void 0:T.length)!==0){E.next=20;break}return R.setFieldsValue({currentPlantDevice:[n,u[0].value]}),E.next=18,G();case 18:V=E.sent,de(V);case 20:case"end":return E.stop()}},l)}));return function(e,n){return c.apply(this,arguments)}}(),Ze=function(){var c=D()(y()().mark(function l(){var e,n,a,r,f,u,g;return y()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,$.Kr)();case 2:n=O.sent,n!=null&&(e=n.data)!==null&&e!==void 0&&e.data&&(f=n==null||(a=n.data)===null||a===void 0?void 0:a.data,u=f==null||(r=f.plantList)===null||r===void 0?void 0:r.map(function(T,V){var N;return{value:T.plantId,label:T.name,children:(f==null||(N=f.deviceCount)===null||N===void 0?void 0:N[V])&&[{value:"",label:""}]}}),(u==null?void 0:u.length)>0&&oe(u,u==null||(g=u[0])===null||g===void 0?void 0:g.value));case 4:case"end":return O.stop()}},l)}));return function(){return c.apply(this,arguments)}}(),ue=function(){var c=D()(y()().mark(function l(){var e,n,a,r,f;return y()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,G();case 2:return n=g.sent,g.next=5,(0,$.Tn)(n);case 5:a=g.sent,a!=null&&(e=a.data)!==null&&e!==void 0&&(e=e.data)!==null&&e!==void 0&&e.data&&(f=a==null||(r=a.data)===null||r===void 0||(r=r.data)===null||r===void 0?void 0:r.data,Oe(f));case 7:case"end":return g.stop()}},l)}));return function(){return c.apply(this,arguments)}}(),de=function(){var c=D()(y()().mark(function l(e){var n,a,r;return y()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return le(!0),u.next=3,(0,$.lp)(e);case 3:a=u.sent,a!=null&&(n=a.data)!==null&&n!==void 0&&(n=n.data)!==null&&n!==void 0&&n.data?ee(a==null||(r=a.data)===null||r===void 0||(r=r.data)===null||r===void 0?void 0:r.data):ee([]),le(!1);case 6:case"end":return u.stop()}},l)}));return function(e){return c.apply(this,arguments)}}();return(0,t.useEffect)(function(){We()},[m]),(0,t.useEffect)(function(){Ze(),ue()},[]),(0,o.jsxs)(p.Z,{size:10,direction:"vertical",style:{width:"100%",height:"100%",padding:30},children:[(0,o.jsxs)(Y.Z,{justify:"center",align:"center",gap:10,children:[(0,o.jsx)(M.Z,{form:R,layout:"inline",initialValues:{currentPlantDevice:[],dayTime:[me,ge],yearTime:P()(),timeType:"day"},children:(0,o.jsxs)(Y.Z,{align:"center",children:[(0,o.jsx)(M.Z.Item,{name:"currentPlantDevice",label:s.formatMessage({id:"\u8BBE\u5907"}),children:(0,o.jsx)(z.Z,{changeOnSelect:!0,options:re,onChange:function(){var c=D()(y()().mark(function l(e){return y()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:(e==null?void 0:e.length)===1&&oe(re,e[0]);case 1:case"end":return a.stop()}},l)}));return function(l){return c.apply(this,arguments)}}(),style:{width:"250px",height:40}})}),(0,o.jsx)(M.Z.Item,{noStyle:!0,dependencies:["timeType"],children:function(l){var e=l.getFieldsValue,n=e(["timeType"]),a=n.timeType;return a==="day"?(0,o.jsx)(H.Z,{title:s.formatMessage({id:"\u65E5\u671F\u8303\u56F4\u6700\u5C11\u9009\u62E95\u5929\u6700\u591A\u9009\u62E912\u5929\uFF01"}),children:(0,o.jsx)(M.Z.Item,{name:"dayTime",label:s.formatMessage({id:"\u65E5\u671F"}),children:(0,o.jsx)(K.Z.RangePicker,{maxDate:P()(B()().subtract(1,"day").format("YYYY-MM-DD"),"YYYY-MM-DD"),style:{width:"300px",height:40},allowClear:!1})})}):(0,o.jsx)(M.Z.Item,{name:"yearTime",label:s.formatMessage({id:"\u65E5\u671F"}),children:(0,o.jsx)(K.Z,{allowClear:!1,maxDate:P()(B()().format("YYYY")),picker:"year",style:{width:"250px",height:40}})})}}),(0,o.jsx)(M.Z.Item,{name:"timeType",children:(0,o.jsxs)(j.ZP.Group,{size:"large",children:[(0,o.jsx)(j.ZP.Button,{value:"day",children:s.formatMessage({id:"\u65E5"})}),(0,o.jsx)(j.ZP.Button,{value:"year",children:s.formatMessage({id:"\u5E74"})})]})})]})}),(0,o.jsx)(w.ZP,{onClick:D()(y()().mark(function c(){var l;return y()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,G();case 2:l=n.sent,l&&(de(l),ue());case 4:case"end":return n.stop()}},c)})),type:"primary",style:{padding:"0 20px",height:40},children:s.formatMessage({id:"\u67E5\u8BE2"})}),(0,o.jsxs)(w.ZP,{type:"primary",onClick:D()(y()().mark(function c(){var l,e;return y()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,G();case 2:return l=a.sent,a.next=5,(0,$._n)(l);case 5:e=a.sent,e!=null&&e.data&&(0,fe.Sv)({fileName:"".concat(s.formatMessage({id:"\u7535\u91CF\u7EDF\u8BA1"}),".xlsx"),content:e==null?void 0:e.data});case 7:case"end":return a.stop()}},c)})),style:{backgroundColor:De.defaultBg,padding:"0 20px",height:40},children:[s.formatMessage({id:"\u5BFC\u51FA"})," Excel"]})]}),(0,o.jsx)(F.Dx,{title:"".concat(s.formatMessage({id:"\u7535\u91CF\u7EDF\u8BA1"}))}),(0,o.jsx)(k.Z,{spinning:se,children:(0,o.jsx)(p.Z,{direction:"vertical",style:{width:"100%"},children:(0,o.jsx)("div",{style:{width:"100%",height:"calc(50vh - 150px)"},children:(m==null?void 0:m.length)>0?(0,o.jsx)(_.Z,{option:Ce,notMerge:!0,style:{width:"100%",height:"100%"}}):(0,o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,o.jsx)(x.Z,{image:x.Z.PRESENTED_IMAGE_SIMPLE,description:s.formatMessage({id:"\u6682\u65E0\u6570\u636E"})})})})})}),(0,o.jsx)(F.Dx,{title:"".concat(s.formatMessage({id:"\u7535\u91CF\u660E\u7EC6"}))}),(0,o.jsx)(k.Z,{spinning:se,children:(0,o.jsx)(p.Z,{direction:"vertical",style:{width:"100%"},children:(0,o.jsx)("div",{style:{width:"100%",height:"calc(50vh - 150px)"},children:(m==null?void 0:m.length)>0?(0,o.jsx)(X.Z,{pagination:!1,dataSource:Ie,columns:[{title:s.formatMessage({id:"\u65E5\u671F"}),dataIndex:"time",key:"time",render:function(l,e){return B()(l).format((e==null?void 0:e.dateType)==="year"?"YYYY/MM":"YYYY/MM/DD")}},{title:s.formatMessage({id:"\u8BBE\u5907\u540D\u79F0"}),dataIndex:"dtuName",key:"dtuName"},{title:s.formatMessage({id:"sn\u53F7"}),dataIndex:"sn",key:"sn"},{title:"".concat(s.formatMessage({id:"\u603B\u5145\u7535\u91CF"}),"/").concat(s.formatMessage({id:"\u603B\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(l,e){return"".concat(e==null?void 0:e.dayChargeEnergy,"/").concat(e==null?void 0:e.dayDischargeEnergy)}},{title:"".concat(s.formatMessage({id:"\u5145\u653E\u7535\u6548\u7387"}),"(%)"),dataIndex:"cDEfficiency",key:"cDEfficiency"},{title:"".concat(s.formatMessage({id:"\u6536\u76CA"}),"(\u5143)"),dataIndex:"number",key:"number"},{title:"".concat(s.formatMessage({id:"\u5C16\u65F6\u6BB5"})).concat(s.formatMessage({id:"\u5145\u7535\u91CF"}),"/").concat(s.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(l,e){return"".concat(e==null?void 0:e.tipChargeEnergy,"/").concat(e==null?void 0:e.tipDischargeEnergy)}},{title:"".concat(s.formatMessage({id:"\u5CF0\u65F6\u6BB5"})).concat(s.formatMessage({id:"\u5145\u7535\u91CF"}),"/").concat(s.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(l,e){return"".concat(e==null?void 0:e.peakChargeEnergy,"/").concat(e==null?void 0:e.peakDischargeEnergy)}},{title:"".concat(s.formatMessage({id:"\u5E73\u65F6\u6BB5"})).concat(s.formatMessage({id:"\u5145\u7535\u91CF"}),"/").concat(s.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(l,e){return"".concat(e==null?void 0:e.flatChargeEnergy,"/").concat(e==null?void 0:e.flatDischargeEnergy)}},{title:"".concat(s.formatMessage({id:"\u8C37\u65F6\u6BB5"})).concat(s.formatMessage({id:"\u5145\u7535\u91CF"}),"/").concat(s.formatMessage({id:"\u653E\u7535\u91CF"}),"(kWh)"),dataIndex:"kWh",key:"kWh",render:function(l,e){return"".concat(e==null?void 0:e.valleyChargeEnergy,"/").concat(e==null?void 0:e.valleyDischargeEnergy)}}],scroll:{y:"calc(50vh - 250px)"}}):(0,o.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,o.jsx)(x.Z,{image:x.Z.PRESENTED_IMAGE_SIMPLE,description:s.formatMessage({id:"\u6682\u65E0\u6570\u636E"})})})})})})]})};C.default=ye}}]);
